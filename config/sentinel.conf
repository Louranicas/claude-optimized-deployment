# Redis Sentinel configuration for rate limiting Redis
# Claude-Optimized Deployment Engine

# Sentinel port
port 26379

# Bind to all interfaces
bind 0.0.0.0

# Directory for temporary files
dir /tmp

# Monitor the master Redis instance
sentinel monitor claude-redis redis-rate-limiting 6379 1

# Master authentication (if needed)
# sentinel auth-pass claude-redis <password>

# How long to wait before considering master down (milliseconds)
sentinel down-after-milliseconds claude-redis 5000

# How many slaves to reconfigure at once during failover
sentinel parallel-syncs claude-redis 1

# Failover timeout (milliseconds)
sentinel failover-timeout claude-redis 10000

# Deny scripts reconfig
sentinel deny-scripts-reconfig yes

# Logging
loglevel notice
logfile ""

# Client limits
sentinel myid $(cat /proc/sys/kernel/random/uuid | tr -d -)

# Network settings
tcp-keepalive 60

# Sentinel configuration for rate limiting specific requirements
# Fast failover for high availability
sentinel down-after-milliseconds claude-redis 3000
sentinel failover-timeout claude-redis 6000

# Rate limiting specific monitoring
# Monitor memory usage
# sentinel notification-script claude-redis /opt/scripts/notify.sh

# Configuration templates for different environments
#
# Production (High Availability):
# sentinel monitor claude-redis-prod redis-master 6379 2
# sentinel down-after-milliseconds claude-redis-prod 10000
# sentinel failover-timeout claude-redis-prod 30000
# sentinel parallel-syncs claude-redis-prod 1
#
# Development (Fast failover):
# sentinel monitor claude-redis-dev redis-master 6379 1
# sentinel down-after-milliseconds claude-redis-dev 2000
# sentinel failover-timeout claude-redis-dev 5000
# sentinel parallel-syncs claude-redis-dev 2
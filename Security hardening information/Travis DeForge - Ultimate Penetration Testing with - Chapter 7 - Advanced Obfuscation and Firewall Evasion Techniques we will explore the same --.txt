# Security Chapter Extract
Book: Travis DeForge - Ultimate Penetration Testing with Nmap_ Master Cybersecurity Assessments for Network Security, Monitoring, and Scanning Using N (2024, Orange Education Pvt Ltd, AVA™) - libgen.li
Chapter: 7 - Advanced Obfuscation and Firewall Evasion Techniques, we will explore the same --max-retries flag from a completely different perspective.
 --host-timeout: Sometimes individual hosts take an extraordinarily long time to scan. This can be caused by a number of factors such as rate limiting or firewalls, and in extreme cases, 1% of the hosts on your target list can take more than 20% of the time of the entire scan. To mitigate this issue, you can specify a host timeout value in minutes, which is the maximum amount of time Nmap will attempt to gather all information before moving on to another host. If Nmap hits the host timeout limit and moves on, you will lose all information on that host. For this reason, do not set an unreasonably low –-host-timeout, as you will likely miss out on a significant amount of important information. This command is most effective when you are running a scan that will take a very long time (perhaps overnight) and you want to make sure that what should take 8 hours to run doesn’t get delayed to 12 hours because of a handful of hosts.
 --defeat-rst-ratelimit: Many hosts will reduce the number of ICMP error messages (RST packets) that are sent back when unreachable ports are queried. The implemented rate limits on sending the packets back to Nmap will impact the adaptive timing nature of Nmap and can significantly slow down the scan as a result. Specifying the --defeat-rst-ratelimit will trade accuracy for speed by ignoring the rate limits entirely, which can result in Nmap not waiting long enough for the results to be returned.
 --defeat-icmp-ratelimit: Very similar to --defeat-rst-ratelimit, the –-defeat-icmp-ratelimit flag is used to increase the speed of UDP scans specifically. Keep in mind that the same drawbacks to accuracy apply.
Security Relevance Score: 3
Word Count: 348
Extracted: 2025-06-13 23:40:38

---

Advanced Obfuscation and Firewall Evasion Techniques, we will explore the same --max-retries flag from a completely different perspective.
 --host-timeout: Sometimes individual hosts take an extraordinarily long time to scan. This can be caused by a number of factors such as rate limiting or firewalls, and in extreme cases, 1% of the hosts on your target list can take more than 20% of the time of the entire scan. To mitigate this issue, you can specify a host timeout value in minutes, which is the maximum amount of time Nmap will attempt to gather all information before moving on to another host. If Nmap hits the host timeout limit and moves on, you will lose all information on that host. For this reason, do not set an unreasonably low –-host-timeout, as you will likely miss out on a significant amount of important information. This command is most effective when you are running a scan that will take a very long time (perhaps overnight) and you want to make sure that what should take 8 hours to run doesn’t get delayed to 12 hours because of a handful of hosts.
 --defeat-rst-ratelimit: Many hosts will reduce the number of ICMP error messages (RST packets) that are sent back when unreachable ports are queried. The implemented rate limits on sending the packets back to Nmap will impact the adaptive timing nature of Nmap and can significantly slow down the scan as a result. Specifying the --defeat-rst-ratelimit will trade accuracy for speed by ignoring the rate limits entirely, which can result in Nmap not waiting long enough for the results to be returned.
 --defeat-icmp-ratelimit: Very similar to --defeat-rst-ratelimit, the –-defeat-icmp-ratelimit flag is used to increase the speed of UDP scans specifically. Keep in mind that the same drawbacks to accuracy apply.

We have previously discussed the use of the timing flag (-T1, T2, T3, T4, T5) and established that T3 is Nmap’s default and T5 is the maximum speed. Now that you understand the performance flags and their function, it is important to dive deeper into the exact difference between T4 and T

# Security Chapter Extract
Book: Travis DeForge - Ultimate Penetration Testing with Nmap_ Master Cybersecurity Assessments for Network Security, Monitoring, and Scanning Using N (2024, Orange Education Pvt Ltd, AVA™) - libgen.li
Chapter: 255 - Heuristically speaking, seeing a single endpoint systematically scanning every single IP in a subnet in order is very obviously a malicious port scan and will likely be identified as such. Detection of this nature is triggered by the nature of the activity (heuristics). The default behavior of scanning the top 1000 ports in a known fixed order also contributes to the probability of heuristic detection.
In contrast to heuristic-based detection, many security products will also employ signature-based detection to identify the activity of specific known malicious tools. Nmap packets, by default, have fixed size and time to live (TTL) values of 40 bytes and 64 seconds, respectively. This means that unless these values are manipulated, the probability of detection is high regardless of how obfuscated the activity is.
As a reminder, Nmap also scans at the T3 speed by default, which is quite fast. Scanning a lot of endpoints very quickly is considered “noisy” on the network and is counterproductive to remaining under the noise floor. Being the most flagrant IP address on the network in terms of network traffic will likely raise eyebrows on the networking team and, in turn, the security team.
Thankfully for penetration testers, and much to the chagrin of those selling enterprise security products, every one of these default options can be modified and calibrated to tailor scans that are much more capable of avoiding both heuristic and signature-based detection.
Advanced Flags for Obfuscation
Security Relevance Score: 6
Word Count: 389
Extracted: 2025-06-13 23:40:38

---

Heuristically speaking, seeing a single endpoint systematically scanning every single IP in a subnet in order is very obviously a malicious port scan and will likely be identified as such. Detection of this nature is triggered by the nature of the activity (heuristics). The default behavior of scanning the top 1000 ports in a known fixed order also contributes to the probability of heuristic detection.
In contrast to heuristic-based detection, many security products will also employ signature-based detection to identify the activity of specific known malicious tools. Nmap packets, by default, have fixed size and time to live (TTL) values of 40 bytes and 64 seconds, respectively. This means that unless these values are manipulated, the probability of detection is high regardless of how obfuscated the activity is.
As a reminder, Nmap also scans at the T3 speed by default, which is quite fast. Scanning a lot of endpoints very quickly is considered “noisy” on the network and is counterproductive to remaining under the noise floor. Being the most flagrant IP address on the network in terms of network traffic will likely raise eyebrows on the networking team and, in turn, the security team.
Thankfully for penetration testers, and much to the chagrin of those selling enterprise security products, every one of these default options can be modified and calibrated to tailor scans that are much more capable of avoiding both heuristic and signature-based detection.
Advanced Flags for Obfuscation

-f: This flag modifies the scan by causing Nmap to employ smaller fragmented packets rather than a complete packet. This helps with the obfuscation of the scan by making it more difficult for intrusion detection systems to identify. While this flag by itself often will not bypassdetection against modern systems, it can be readily combined with many other options when conducting TCP and UDP scans to do so. 
An important thing to note is that packet fragmentation is meant for raw packet frames only. This means that port scans and service versioning will work well, but things like operating system version (-O) and most NSE scripts will not support fragmentation.
--randomize-hosts: When Nmap operates against a range of endpoints by default, it scans in numerical order. For example, if you were to scan 10.10.10.0/24, the first host scanned would be 10.10.10.0, then 10.10.10.1, 10.10.10.2, and so on up to 10.10.10.
